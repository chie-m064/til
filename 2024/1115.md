# 掲示板の一覧機能の作成
## 概要
* データベースのBoardsテーブルにレコードが無い場合は、「掲示板がありません」とページに表示すること。
* データベースのBoardsテーブルのレコード一覧を掲示板一覧として表示すること。
  * 表示するものは以下のとおり。
    * 掲示板のタイトル（title）
    * 掲示板の本文（body）
    * 掲示板を投稿したユーザーのフルネーム
    * 掲示板を投稿した日時（created_at）

* 上記に加えて以下の条件を満たしていること。
  * UsersテーブルとBoardsテーブルのリレーションは「1対多」にすること。
  * Boardの登録には誰が投稿したかが分かるように、外部キーにUser情報を含めること。
  * Boardに対して以下のバリデーションが機能すること。
    * titleカラムは255文字以下であること。
    * bodyカラムは65535文字以下であること。
  * 未ログイン状態で掲示板一覧画面にアクセスすると、ログインページにリダイレクトされること。
 
##　実装イメージ
```
- ■Boardモデル・Boardsテーブルを生成する
  - docker compose exec web rails g model Board コマンドを実行する
  - app/models/board.rbを編集する
  - マイグレーションファイルの編集する
  - データベースにマイグレーションファイルを適用する
- ■掲示版一覧画面へのルーティング設定する
  - config/routes.rbに resources :boards, only: %i[index] を記載する
- ■設定したルーティングに対応するコントローラーとアクションを用意する
  - docker compose exec web rails g controller boards コマンドを実行する
  - app/controllers/boards_controller.rbにindexアクションを定義する
- ■用意したコントローラーとアクションに対応するビューを用意する
  - app/views/boards/index.html.erbを生成・編集する
  - app/assets/images/配下にboard_placeholder.pngを配置する
  - app/views/boards/_board.html.erbを生成・編集する
- ■見た目・導線を整える
  - app/views/boards/index.html.erbを編集する
  - config/application.rbを編集する
  - config/locales/views/ja.ymlを編集する
  - app/controllers/application_controller.rbを編集する
  - app/controllers/user_sessions_controller.rbを編集する
- ■Boardレコードを用意する
  - RailsコンソールでBoardレコードを生成する
  - db/seeds.rbを用いてレコードを生成する
```

```mermaid
erDiagram
  Users ||--o{ Boards : "1人のユーザーは0以上の投稿を持つ"

    Users {
        bigint id PK
        string email "メールアドレス"
        string crypted_password "パスワード"
        string salt
        string first_name "名"
        string last_name "姓"
        timedtamp created_at "作成日時"
        timestamp updated_at "更新日時"
    }
    Boards {
        string title "件名"
        text body "本文"
        references user_id FK "外部キー"
        timedtamp created_at "作成日時"
        timestamp updated_at "更新日時"
    }
```

## Boardモデル・Boardsテーブルを生成する
```ruby:app/models/board.rb
class Board < ApplicationRecord
  validates :title, presence: true, length: { maximum: 255 }
  validates :body, presence: true, length: { maximum: 65_535 }

/BoardモデルがUserモデルに属していることを示す。Boardモデルの各レコードはUserモデルのレコードに関連つけられることになる
  belongs_to :user
end
```
```ruby:app/models/user.rb
class User < ApplicationRecord
  ... 省略 ...

/ユーザーが複数のBoardレコードを持つことを示す
  has_many :boards, dependent: :destroy
end
```
### アソシエーションとは
アソシエーションとは、Railsのモデル間の関連性を定義する機能です。これにより、異なるモデル同士がどのように結びついているかを簡単に表現できます。主なアソシエーションには、has_one、has_many、belongs_to があります。それぞれの使い方と概念を理解し、モデル間の関係を適切に設定しましょう。

#### has_one
has_oneアソシエーションは、1つのモデルが他のモデルと1対1で関連付けられる場合に使用します。例えば、ユーザーが1つのプロフィールを持つ場合、Userモデルに対してProfileモデルをhas_one :profile と定義します。これにより、Userモデルのインスタンスから関連づいたプロフィール情報を簡単に取得できます。

#### has_many
has_manyアソシエーションは、1つのモデルが複数の他のモデルと関連付けられる場合に使用します。例えば、ユーザーが複数の掲示板を持つ場合、Userモデルに対してBoardモデルを has_many :boards と定義します。これにより、Userモデルのインスタンスからそのユーザーが投稿した複数の掲示板情報を簡単に取得できます。

#### belongs_to
belongs_toアソシエーションは、1つのモデルが他のモデルに属する場合に使用します。例えば、掲示板がユーザーに属する場合、Boardモデルに対してUserモデルを belongs_to :user と定義します。これにより、Boardモデルのインスタンスから投稿者であるユーザー情報を簡単に取得できます。

### 適応したマイグレーションファイルを修正したい時
$ docker compose exec web rails db:migrate:status

* 対象のマイグレーションをdownする
$ docker compose exec web rails db:rallback STEP=1
  * STEP=1 は、1つ前のマイグレーションに戻すことを意味します。複数のマイグレーションを戻す場合は必要なSTEP数を指定してください。

* マイグレーションを修正する
  * down状態に戻した後、マイグレーションの修正を行います

* 再度マイグレーションを適用する
$ docker compose exec web rails db:migrate 
